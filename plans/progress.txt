# Kanban Board Progress

## Issue #3: Board navigation & view [DONE]
- Fixed `columns.list` to sort by `position` field (was returning unsorted)
- Created `KanbanBoard` and `KanbanColumn` presentational components in `src/components/ui/kanban/` (compose shadcn Card, no Convex imports)
- Updated `src/routes/boards/$boardId.tsx` to query columns and render them via `KanbanBoard`, replacing the placeholder
- Added Convex tests for `boards.get` (single board by ID) and `columns.list` (position ordering)
- Commit: fccd04d

## Issue #4: Column creation [DONE]
- Added `columns.create` mutation that appends new column at max position + 1 (`convex/columns.ts`)
- Added "Add Column" button + dialog to `KanbanBoard` presentational component (`src/components/ui/kanban/kanban-board.tsx`)
- Wired `createColumn` mutation in board route container (`src/routes/boards/$boardId.tsx`)
- Added 2 Convex tests: appending after existing columns, first column on empty board (`convex/columns.test.ts`)
- Commit: 632e5fc

## Issue #5: Card creation & display [DONE]
- Added `convex/cards.ts` with `list` query (cards for a board, ordered by position) and `create` mutation (appends at end of column)
- Added `convex/cards.test.ts` with 2 tests: card placement at end of column, cards listed in position order across columns
- Created `KanbanCard` presentational component (`src/components/ui/kanban/kanban-card.tsx`) composing shadcn Card, no Convex imports
- Updated `KanbanColumn` with cards display, "+" button, and add-card modal dialog
- Updated `KanbanBoard` and board route container to pass cards data and `onAddCard` callback through
- Commit: 50484f2

## Issue #6: Card detail modal (edit & delete) [DONE]
- Added `cards.update` mutation (title + description) and `cards.remove` mutation (deletes card, recalculates positions) in `convex/cards.ts`
- Created `KanbanCardDetailModal` component (`src/components/ui/kanban/kanban-card-detail-modal.tsx`) with editable fields and AlertDialog delete confirmation
- Updated card creation flow to support optional description (mutation args, add-card modal in `KanbanColumn`, route container wiring)
- Fixed stale-state bug: modal remounts via `key={selectedCard?._id}` so each card gets fresh form state
- Added 2 Convex tests in `convex/cards.test.ts`: update persists changes, delete maintains position order
- Commit: c7d1688

## Issue #7: Card move (manual) [DONE]
- Added `cards.move` mutation handling cross-column moves and within-column reorder with position recalculation (`convex/cards.ts`)
- Created `KanbanCardMoveModal` component with column and position selectors (`src/components/ui/kanban/kanban-card-move-modal.tsx`)
- Added "Move" button to card detail modal footer, transitions to move modal (`kanban-card-detail-modal.tsx`, `kanban-board.tsx`)
- Wired `moveCard` mutation in board route container (`src/routes/boards/$boardId.tsx`)
- Added 2 Convex tests: cross-column move updates both columns' positions, within-column reorder updates positions correctly (`convex/cards.test.ts`)
- Commit: 9f1f730

## Issue #8: Card drag and drop [DONE]
- Added `@dnd-kit/core`, `@dnd-kit/sortable`, `@dnd-kit/utilities` as dependencies
- Made cards sortable within columns (`SortableKanbanCard` with `useSortable`, `SortableContext` per column) and droppable across columns (`useDroppable` on column card areas) in `kanban-column.tsx`
- Wrapped board in `DndContext` with `PointerSensor` (8px activation constraint), `KeyboardSensor`, `closestCorners` collision detection, and `DragOverlay` with rotated card clone in `kanban-board.tsx`
- Added Convex optimistic update on `cards.move` mutation in `src/routes/boards/$boardId.tsx` to eliminate visual snap-back after drop
- Manual "Move" action from slice 6 remains available alongside drag-and-drop
- Commit: ef98e55

## Next up
- Issue #4 continued: Column rename (click-to-rename header + `columns.rename` mutation + test)
